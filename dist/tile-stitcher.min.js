var tileStitcher=function(e,t){function i(e,t){for(var n in t)e=e.replace(new RegExp("{"+n+"}","g"),t[n]);return e}function s(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}}function o(e){return i(n.url,e)}function u(e,t){var n=new Image;n.onload=function(){t(this)},n.src=e}function a(e,t,n,r,i){u(e,function(e){var s=e.width,o=e.height,u=r.getContext("2d");u.drawImage(e,t*s,n*o),i(r)})}function f(e,t,n,r,i,s,u){var f,l,c;for(f=e;f<=n;f++)for(l=t;l<=r;l++)c=o({x:f,y:l,z:i}),a(c,f-e,l-t,s,u)}function l(e,t,n,r,i,s,u){var f,l,c;for(f=e;f<=n;f++)for(l=r;l>=t;l--)c=o({x:f,y:l,z:i}),a(c,f-e,r-l,s,u)}var n={};n.url=e,n.options={scheme:"xyz",tileSize:256};var r;for(r in t)t.hasOwnProperty(r)&&(n.options[r]=t[r]);return n.stitch=function(e,t,r,i,o,u){var a=r-e+1,c=i-t+1,h=a*c,p=s(h,u),d=document.createElement("canvas");d.width=a*n.options.tileSize,d.height=c*n.options.tileSize,n.options.scheme==="tms"?l(e,t,r,i,o,d,p):f(e,t,r,i,o,d,p)},n};